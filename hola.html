Para este proyecto, utilizamos un entorno de pruebas basado en Parrot OS y Metasploitable, dos plataformas ampliamente reconocidas en el ámbito de la seguridad informática y el hacking ético. Parrot OS, una distribución de Linux diseñada para pruebas de penetración, y Metasploitable, una máquina virtual intencionalmente vulnerable, nos proporcionaron un escenario controlado para simular ataques y buscar vulnerabilidades. La configuración del entorno incluyó la instalación de Parrot OS y Metasploitable en máquinas virtuales, asegurando su conectividad a través de una red interna para facilitar la simulación de ataques y la captura del tráfico de red.

Una vez establecido el entorno de pruebas, seleccionamos Nmap como nuestra herramienta de hacking ético. Nmap es una poderosa herramienta de escaneo de redes utilizada para descubrir hosts y servicios en una red, lo que la convierte en una opción ideal para nuestros propósitos. Utilizamos Nmap para realizar escaneos de puertos en la máquina Metasploitable desde Parrot OS, aplicando comandos específicos como nmap -sS -p 1-65535 <IP> para ejecutar un escaneo de puertos completo. Esta etapa nos permitió observar y registrar el comportamiento típico de un escaneo de puertos, proporcionando una base para la detección de tales actividades en futuras fases del proyecto.

Para la detección y mitigación de los escaneos de puertos, desarrollamos una solución en Python utilizando la biblioteca Scapy. Esta herramienta permitió la captura y análisis de paquetes de red en tiempo real. Implementamos un script que detecta paquetes SYN entrantes dirigidos a nuestra IP, lo que indica un posible escaneo de puertos. El script verifica si el paquete tiene solo el flag SYN activado y, de ser así, registra la dirección IP del atacante, envía una alerta por correo electrónico y actualiza una barra de progreso en la consola para monitorear el número de intentos de escaneo detectados. Esta solución asegura que se envíe una alerta única por cada dirección IP atacante, evitando múltiples alertas por la misma fuente.

Finalmente, nuestra solución no solo alerta al usuario sobre un posible ataque, sino que también está diseñada para mitigar el impacto de futuros intentos del mismo atacante. La implementación en Python incluye la capacidad de bloquear direcciones IP que han sido identificadas como fuentes de escaneo de puertos, cortando efectivamente el ataque y previniendo su repetición. Además, la herramienta de alerta asegura que el usuario sea informado inmediatamente, permitiendo una rápida respuesta y mejora en la seguridad de la red. Esta metodología integral garantiza una protección robusta contra escaneos de puertos, combinando detección en tiempo real, alerta proactiva y medidas de mitigación efectivas.